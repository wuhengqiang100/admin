<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xiaoshu.admin.mapper.FarmDataMapper">

  <!-- 通用查询映射结果 -->
  <resultMap id="BaseResultMap" type="com.xiaoshu.admin.entity.FarmData">
    <result column="id" property="id" />
    <result column="time" property="time" />
    <result column="temperature" property="temperature" />
    <result column="humidity" property="humidity" />
    <result column="illumination" property="illumination" />
    <result column="farm_id" property="farmId" />
    <collection property="farm"  ofType="com.xiaoshu.admin.entity.Farm">
      <result property="id" column="farm.id"/>
      <result property="name" column="name"/>
      <result property="location" column="location"/>
      <result property="temperature" column="temperature"/>
      <result property="humidity" column="humidity"/>
      <result property="illumination" column="illumination"/>
    </collection>
  </resultMap>


  <resultMap type="com.xiaoshu.admin.entity.FarmData" id="FarmDataMap">
    <result column="id" property="id" />
    <result column="time" property="time" />
    <result column="temperature" property="temperature" />
    <result column="humidity" property="humidity" />
    <result column="illumination" property="illumination" />
    <result column="farm_id" property="farmId" />
    <collection property="farm"  ofType="com.xiaoshu.admin.entity.Farm">
      <result property="id" column="farm.id"/>
      <result property="name" column="name"/>
      <result property="location" column="location"/>
      <result property="temperature" column="temperature"/>
      <result property="humidity" column="humidity"/>
      <result property="illumination" column="illumination"/>
    </collection>
  </resultMap>

  <select id="getFarmDataByFarmId" resultMap="FarmDataMap" parameterType="java.lang.String">
    SELECT
    nt.id,
    nt.time,
    nt.temperature,
    nt.humidity,
    nt.illumination,
    nt.farm_id,
    tf.id,
    tf.name,
    tf.location,
    tf.temperature,
    tf.humidity,
    tf.illumination
    from
    nongtianmysqldata nt
    left join t_farm  tf 	on 	    nt.farm_id = tf.id
    where
    tf.del_flag = FALSE
    <if test="farmId != '' and farmId != null">
      and tf.id = #{farmId}
    </if>
  </select>
  <select id="selectFarmDataById" resultMap="FarmDataMap"  parameterType="java.lang.String">
    SELECT
    nt.id,
    nt.time,
    nt.temperature,
    nt.humidity,
    nt.illumination,
    nt.farm_id,
    tf.id,
    tf.name,
    tf.location,
    tf.temperature,
    tf.humidity,
    tf.illumination
    from
    nongtianmysqldata nt
    left join t_farm  tf 	on 	    nt.farm_id = tf.id
    where
    tf.del_flag = FALSE
    <if test="id != '' and id != null">
      and nt.id = #{id}
    </if>
  </select>


</mapper>